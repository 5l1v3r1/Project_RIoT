#!/bin/bash

# This script for parsing CVE and exploits from Shodan...

cyan='\e[96m'
red='\e[91m'
green='\e[92m'
default='\e[0m'
yellow='\e[93m'

target=`cat temp.txt`
echo -en "$cyan[$red+$cyan]$default Asking Shodan about this target machine.\n"
look=`curl -sSL https://www.shodan.io/host/$target`
for((year=1999;year<2020;year++))
do
   echo $look | grep -o "CVE-$year-[0-9]*" &>/dev/null
   if [ $? -eq 0 ];then
     echo -en $cyan"["$red"+"$cyan"]"$default" Year: $green$year"$default"\n"
     echo "--------------------"
     echo $look | grep -o "CVE-$year-[0-9]*"
     echo -en "-------------------- \n\n"
   fi
done
