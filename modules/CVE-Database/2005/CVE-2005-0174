{Modified: 2016-10-17T23:08:07, Published: 2005-02-07T00:00:00, access: {authentication: NONE, complexity: LOW, vector: NETWORK}, cvss: 5.0, cvss-time: 2016-11-02T11:35:26.647000, cwe: Unknown, id: CVE-2005-0174, impact: {availability: NONE, confidentiality: NONE, integrity: PARTIAL}, last-modified: 2017-10-10T21:29:52.467000, nessus: [{NASL family: Mandriva Local Security Checks, NASL id: MANDRAKE_MDKSA-2005-034.NASL, description: More vulnerabilities were discovered in the squid server :

The LDAP handling of search filters was inadequate which could be abused to allow logins using severial variants of a single login name, possibly bypassing explicit access controls (CVE-2005-0173).

Minor problems in the HTTP header parsing code that could be used for cache poisoning (CVE-2005-0174 and CVE-2005-0175).

A buffer overflow in the WCCP handling code allowed remote attackers to cause a Denial of Service and could potentially allow for the execution of arbitrary code by using a long WCCP packet.

The updated packages have been patched to prevent these problems., last seen: 2019-02-21, modified: 2018-07-19, plugin id: 16377, published: 2005-02-11, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16377, title: Mandrake Linux Security Advisory : squid (MDKSA-2005:034)}, {NASL family: Fedora Local Security Checks, NASL id: FEDORA_2005-373.NASL, description: - Mon May 16 2005 Jay Fenlason <fenlason at redhat.com>     7:2.5.STABLE9-1.FC3.6

  - More upstream patches, including ones for bz#157456     CVE-2005-1519 DNS lookups unreliable on untrusted     networks bz#156162 CVE-1999-0710 cachemgr.cgi access     control bypass

  - The following bugs had already been fixed, but the     announcements were lost bz#156711 CVE-2005-1390 HTTP     Request Smuggling Vulnerabilities bz#156703     CVE-2005-1389 HTTP Response Splitting Vulnerabilities     (Both fixed by squid-7:2.5.STABLE8-1.FC3.1) bz#151419     Unexpected access control results on configuration     errors (Fixed by 7:2.5.STABLE9-1.FC3.2)     bz#152647#squid-2.5.STABLE9-1.FC3.4.x86_64.rpm is broken     (fixed by 7:2.5.STABLE9-1.FC3.5) bz#141938 squid ldap     authentification broken (Fixed by 7:2.5.STABLE7-1.FC3)

  - Fri Apr 1 2005 Jay Fenlason <fenlason at redhat.com>     7:2.5.STABLE9-1.FC3.5

  - More upstream patches, including a new version of the
    -2GB patch that doesn't break diskd.

Note that Tenable Network Security has extracted the preceding description block directly from the Fedora security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues., last seen: 2019-02-21, modified: 2018-07-19, plugin id: 18337, published: 2005-05-19, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=18337, title: Fedora Core 3 : squid-2.5.STABLE9-1.FC3.6 (2005-373)}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2005-061.NASL, description: An updated Squid package that fixes several security issues is now available.

Squid is a full-featured Web proxy cache.

A buffer overflow flaw was found in the Gopher relay parser. This bug could allow a remote Gopher server to crash the Squid proxy that reads data from it. Although Gopher servers are now quite rare, a malicious web page (for example) could redirect or contain a frame pointing to an attacker's malicious gopher server. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0094 to this issue.

An integer overflow flaw was found in the WCCP message parser. It is possible to crash the Squid server if an attacker is able to send a malformed WCCP message with a spoofed source address matching Squid's 'home router'. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0095 to this issue.

A memory leak was found in the NTLM fakeauth_auth helper. It is possible that an attacker could place the Squid server under high load, causing the NTML fakeauth_auth helper to consume a large amount of memory, resulting in a denial of service. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0096 to this issue.

A NULL pointer de-reference bug was found in the NTLM fakeauth_auth helper. It is possible for an attacker to send a malformed NTLM type 3 message, causing the Squid server to crash. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0097 to this issue.

A username validation bug was found in squid_ldap_auth. It is possible for a username to be padded with spaces, which could allow a user to bypass explicit access control rules or confuse accounting. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0173 to this issue.

The way Squid handles HTTP responses was found to need strengthening.
It is possible that a malicious web server could send a series of HTTP responses in such a way that the Squid cache could be poisoned, presenting users with incorrect webpages. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the names CVE-2005-0174 and CVE-2005-0175 to these issues.

A bug was found in the way Squid handled oversized HTTP response headers. It is possible that a malicious web server could send a specially crafted HTTP header which could cause the Squid cache to be poisoned, presenting users with incorrect webpages. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0241 to this issue.

A buffer overflow bug was found in the WCCP message parser. It is possible that an attacker could send a malformed WCCP message which could crash the Squid server or execute arbitrary code. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0211 to this issue.

Users of Squid should upgrade to this updated package, which contains backported patches, and is not vulnerable to these issues., last seen: 2019-02-21, modified: 2018-11-15, plugin id: 16384, published: 2005-02-14, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16384, title: RHEL 2.1 / 3 : squid (RHSA-2005:061)}, {NASL family: Debian Local Security Checks, NASL id: DEBIAN_DSA-667.NASL, description: Several vulnerabilities have been discovered in Squid, the internet object cache, the popular WWW proxy cache. The Common Vulnerabilities and Exposures project identifies the following vulnerabilities :

  - CAN-2005-0173     LDAP is very forgiving about spaces in search filters     and this could be abused to log in using several     variants of the login name, possibly bypassing explicit     access controls or confusing accounting.

  - CAN-2005-0175

    Cache pollution/poisoning via HTTP response splitting     has been discovered.

  - CAN-2005-0194

    The meaning of the access controls becomes somewhat     confusing if any of the referenced ACLs (access control     lists) is declared empty, without any members.

  - CAN-2005-0211

    The length argument of the WCCP recvfrom() call is     larger than it should be. An attacker may send a larger     than normal WCCP packet that could overflow a buffer., last seen: 2019-02-21, modified: 2018-08-09, plugin id: 16341, published: 2005-02-10, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16341, title: Debian DSA-667-1 : squid - several vulnerabilities}, {NASL family: Ubuntu Local Security Checks, NASL id: UBUNTU_USN-77-1.NASL, description: A possible authentication bypass was discovered in the LDAP authentication backend. LDAP ignores leading and trailing whitespace in search filters. This could possibly be abused to bypass explicit access controls or confuse accounting when using several variants of the login name. (CAN-2005-0173)

Previous Squid versions were not strict enough while parsing HTTP requests and responses. Various violations of the HTTP protocol, such as multiple Content-Length header lines, invalid 'Carriage Return' characters, and HTTP header names containing whitespace, led to cache pollution and could possibly be exploited to deliver wrong content to clients. (CAN-2005-0174)

Squid was susceptible to a cache poisoning attack called 'HTTP response splitting', where false replies are injected in the HTTP stream. This allowed malicious web servers to forge wrong cache content for arbitrary websites, which was then delivered to Squid clients. (CAN-2005-0175)

The FSC Vulnerability Research Team discovered a buffer overflow in the WCCP handling protocol. By sending an overly large WCCP packet, a remote attacker could crash the Squid server, and possibly even execute arbitrary code with the privileges of the 'proxy' user.
(CAN-2005-0211).

Note that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues., last seen: 2019-02-21, modified: 2018-07-19, plugin id: 20699, published: 2006-01-15, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=20699, title: Ubuntu 4.10 : squid vulnerabilities (USN-77-1)}, {NASL family: Gentoo Local Security Checks, NASL id: GENTOO_GLSA-200502-04.NASL, description: The remote host is affected by the vulnerability described in GLSA-200502-04 (Squid: Multiple vulnerabilities)

    Squid contains several vulnerabilities:
    Buffer overflow when handling WCCP recvfrom()     (CAN-2005-0211).
    Loose checking of HTTP headers (CAN-2005-0173 and     CAN-2005-0174).
    Incorrect handling of LDAP login names with spaces     (CAN-2005-0175).
  Impact :

    An attacker could exploit:
    the WCCP buffer overflow to cause Denial of Service.
    the HTTP header parsing vulnerabilities to inject arbitrary     response data, potentially leading to content spoofing, web cache     poisoning and other cross-site scripting or HTTP response splitting     attacks.
    the LDAP issue to login with several variations of the same login     name, leading to log poisoning.
  Workaround :

    There is no known workaround at this time., last seen: 2019-02-21, modified: 2018-08-10, plugin id: 16441, published: 2005-02-14, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16441, title: GLSA-200502-04 : Squid: Multiple vulnerabilities}, {NASL family: Firewalls, NASL id: SQUID_WCCP_AND_GOPHER_FLAWS.NASL, description: According to its version number, the remote Squid caching proxy is affected by several security flaws :

  - There is a buffer overflow when handling the reply of a     rogue gopher site. (CVE-2005-0094)

  - There is a denial of service vulnerability in the WCCP     code of the remote proxy. (CVE-2005-0095)

  - There is a buffer overflow in the WCCP code that may     allow an attacker to execute arbitrary code on the     remote host. (CVE-2005-0211)

  - There is a flaw in the 'squid_ldap_auth' module that may     allow an attacker to bypass authentication and to gain     access to the remote proxy. (CVE-2005-0173)

  - There is a flaw in the way Squid parses HTTP reply     headers. (CVE-2005-0241)

  - There is a weakness that may allow for cache poisoning     via     HTTP response splitting. (CVE-2005-0175)

  - There is a weakness that may allow for cache poisoning     via     crafted malformed headers. (CVE-2005-0174)

Note that this may be a false-positive given the way the Squid team handles releases. Make sure that all the appropriate patches have been applied., last seen: 2019-02-21, modified: 2018-07-30, plugin id: 16190, published: 2005-01-18, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16190, title: Squid < 2.5.STABLE8 Multiple Vulnerabilities}, {NASL family: FreeBSD Local Security Checks, NASL id: FREEBSD_PKG_B4D94FA06E3811D99E1EC296AC722CB3.NASL, description: The squid patches page notes :

This patch makes Squid considerably stricter while parsing the HTTP protocol.

- A Content-length header should only appear once in a valid request or response. Multiple Content-length headers, in conjunction with specially crafted requests, may allow Squid's cache to be poisoned with bad content in certain situations.

- CR characters is only allowed as part of the CR NL line terminator, not alone. This to ensure that all involved agrees on the structure of HTTP headers.

- Rejects requests/responses that have whitespace in an HTTP header name.

To enable these strict parsing rules, update to at least squid-2.5.7_9 and specify relaxed_header_parser off in squid.conf., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 19089, published: 2005-07-13, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=19089, title: FreeBSD : squid -- possible cache-poisoning via malformed HTTP responses (b4d94fa0-6e38-11d9-9e1e-c296ac722cb3)}, {NASL family: SuSE Local Security Checks, NASL id: SUSE_SA_2005_006.NASL, description: The remote host is missing the patch for the advisory SUSE-SA:2005:006 (squid).


Squid is a feature-rich web-proxy with support for various web-related protocols.
The last two squid updates from February the 1st and 10th fix several vulnerabilities. The impact of them range from remote denial-of-service over cache poisoning to possible remote command execution.
Due to the hugh amount of bugs the vulnerabilities are just summarized here.

CVE-2005-0094 A buffer overflow in the Gopher responses parser leads to memory corruption and usually crash squid.

CVE-2005-0095 An integer overflow in the receiver of WCCP (Web Cache Communication Protocol) messages can be exploited remotely by sending a specially crafted UDP datagram to crash squid.

CVE-2005-0096 A memory leak in the NTLM fakeauth_auth helper for Squid 2.5.STABLE7 and earlier allows remote attackers to cause a denial-of-service due to uncontrolled memory consumption.

CVE-2005-0097 The NTLM component in Squid 2.5.STABLE7 and earlier allows remote attackers to cause a crash od squid by sending a malformed NTLM message. 

CVE-2005-0173 LDAP handles search filters very laxly. This behaviour can be abused to log in using several variants of a login name, possibly bypassing explicit access controls or confusing accounting.

CVE-2005-0175 and CVE-2005-0174 Minor problems in the HTTP header parsing code that can be used for cache poisoning.

CVE-2005-0211 A buffer overflow in the WCCP handling code in Squid 2.5 before 2.5.STABLE7 allows remote attackers to cause a denial-of-service and possibly execute arbitrary code by using a long WCCP packet.

CVE-2005-0241 The httpProcessReplyHeader function in Squid 2.5-STABLE7 and earlier does not properly set the debug context when it is handling 'oversized' HTTP reply headers. The impact is unknown., last seen: 2019-02-21, modified: 2016-12-27, plugin id: 16372, published: 2005-02-10, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=16372, title: SUSE-SA:2005:006: squid}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2005-060.NASL, description: An updated Squid package that fixes several security issues is now available.

This update has been rated as having important security impact by the Red Hat Security Response Team.

Squid is a full-featured Web proxy cache.

A buffer overflow flaw was found in the Gopher relay parser. This bug could allow a remote Gopher server to crash the Squid proxy that reads data from it. Although Gopher servers are now quite rare, a malicious webpage (for example) could redirect or contain a frame pointing to an attacker's malicious gopher server. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0094 to this issue.

An integer overflow flaw was found in the WCCP message parser. It is possible to crash the Squid server if an attacker is able to send a malformed WCCP message with a spoofed source address matching Squid's 'home router'. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0095 to this issue.

A memory leak was found in the NTLM fakeauth_auth helper. It is possible that an attacker could place the Squid server under high load, causing the NTML fakeauth_auth helper to consume a large amount of memory, resulting in a denial of service. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0096 to this issue.

A NULL pointer de-reference bug was found in the NTLM fakeauth_auth helper. It is possible for an attacker to send a malformed NTLM type 3 message, causing the Squid server to crash. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0097 to this issue.

A username validation bug was found in squid_ldap_auth. It is possible for a username to be padded with spaces, which could allow a user to bypass explicit access control rules or confuse accounting. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0173 to this issue.

The way Squid handles HTTP responses was found to need strengthening.
It is possible that a malicious Web server could send a series of HTTP responses in such a way that the Squid cache could be poisoned, presenting users with incorrect webpages. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the names CVE-2005-0174 and CVE-2005-0175 to these issues.

A bug was found in the way Squid handled oversized HTTP response headers. It is possible that a malicious Web server could send a specially crafted HTTP header which could cause the Squid cache to be poisoned, presenting users with incorrect webpages. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0241 to this issue.

A buffer overflow bug was found in the WCCP message parser. It is possible that an attacker could send a malformed WCCP message which could crash the Squid server or execute arbitrary code. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2005-0211 to this issue.

Users of Squid should upgrade to this updated package, which contains backported patches, and is not vulnerable to these issues., last seen: 2019-02-21, modified: 2018-11-15, plugin id: 17176, published: 2005-02-22, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=17176, title: RHEL 4 : squid (RHSA-2005:060)}], oval: [{accepted: 2013-04-29T04:07:28.795-04:00, class: vulnerability, contributors: [{name: Aharon Chernin, organization: SCAP.com, LLC}, {name: Dragos Prisaca, organization: G2, Inc.}], definition_extensions: [{comment: The operating system installed on the system is Red Hat Enterprise Linux 3, oval: oval:org.mitre.oval:def:11782}, {comment: CentOS Linux 3.x, oval: oval:org.mitre.oval:def:16651}, {comment: The operating system installed on the system is Red Hat Enterprise Linux 4, oval: oval:org.mitre.oval:def:11831}, {comment: CentOS Linux 4.x, oval: oval:org.mitre.oval:def:16636}, {comment: Oracle Linux 4.x, oval: oval:org.mitre.oval:def:15990}], description: Squid 2.5 up to 2.5.STABLE7 allows remote attackers to poison the cache or conduct certain attacks via headers that do not follow the HTTP specification, including (1) multiple Content-Length headers, (2) carriage return (CR) characters that are not part of a CRLF pair, and (3) header names containing whitespace characters., family: unix, id: oval:org.mitre.oval:def:10656, status: accepted, submitted: 2010-07-09T03:56:16-04:00, title: Squid 2.5 up to 2.5.STABLE7 allows remote attackers to poison the cache or conduct certain attacks via headers that do not follow the HTTP specification, including (1) multiple Content-Length headers, (2) carriage return (CR) characters that are not part of a CRLF pair, and (3) header names containing whitespace characters., version: 23}], ranking: [[{circl: 3}]], redhat: {advisories: [{rhsa: {id: RHSA-2005:060}}, {rhsa: {id: RHSA-2005:061}}]}, references: [http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000931, http://fedoranews.org/updates/FEDORA--.shtml, http://marc.info/?l=bugtraq&m=110780531820947&w=2, http://www.kb.cert.org/vuls/id/768702, http://www.mandriva.com/security/advisories?name=MDKSA-2005:034, http://www.novell.com/linux/security/advisories/2005_06_squid.html, http://www.redhat.com/archives/fedora-announce-list/2005-May/msg00025.html, http://www.redhat.com/support/errata/RHSA-2005-060.html, http://www.redhat.com/support/errata/RHSA-2005-061.html, http://www.securityfocus.com/bid/12412, http://www.squid-cache.org/Versions/v2/2.5/bugs/#squid-2.5.STABLE7-header_parsing], refmap: {bid: [12412], bugtraq: [20050207 [USN-77-1] Squid vulnerabilities], cert-vn: [VU#768702], conectiva: [CLA-2005:931], confirm: [http://www.squid-cache.org/Versions/v2/2.5/bugs/#squid-2.5.STABLE7-header_parsing, http://www3.br.squid-cache.org/Advisories/SQUID-2005_4.txt], fedora: [FEDORA-2005-373, FLSA-2006:152809], mandrake: [MDKSA-2005:034], suse: [SUSE-SA:2005:006]}, summary: Squid 2.5 up to 2.5.STABLE7 allows remote attackers to poison the cache or conduct certain attacks via headers that do not follow the HTTP specification, including (1) multiple Content-Length headers, (2) carriage return (CR) characters that are not part of a CRLF pair, and (3) header names containing whitespace characters., vulnerable_configuration: [{id: cpe:2.3:a:squid:squid:2.5.6, title: cpe:2.3:a:squid:squid:2.5.6}, {id: cpe:2.3:a:squid:squid:2.5.stable1, title: cpe:2.3:a:squid:squid:2.5.stable1}, {id: cpe:2.3:a:squid:squid:2.5.stable2, title: cpe:2.3:a:squid:squid:2.5.stable2}, {id: cpe:2.3:a:squid:squid:2.5.stable3, title: cpe:2.3:a:squid:squid:2.5.stable3}, {id: cpe:2.3:a:squid:squid:2.5.stable4, title: cpe:2.3:a:squid:squid:2.5.stable4}, {id: cpe:2.3:a:squid:squid:2.5.stable5, title: cpe:2.3:a:squid:squid:2.5.stable5}, {id: cpe:2.3:a:squid:squid:2.5.stable6, title: cpe:2.3:a:squid:squid:2.5.stable6}, {id: cpe:2.3:a:squid:squid:2.5.stable7, title: cpe:2.3:a:squid:squid:2.5.stable7}, {id: cpe:2.3:a:squid:squid:2.5_.stable1, title: cpe:2.3:a:squid:squid:2.5_.stable1}, {id: cpe:2.3:a:squid:squid:2.5_.stable3, title: cpe:2.3:a:squid:squid:2.5_.stable3}, {id: cpe:2.3:a:squid:squid:2.5_.stable4, title: cpe:2.3:a:squid:squid:2.5_.stable4}, {id: cpe:2.3:a:squid:squid:2.5_.stable5, title: cpe:2.3:a:squid:squid:2.5_.stable5}, {id: cpe:2.3:a:squid:squid:2.5_.stable6, title: cpe:2.3:a:squid:squid:2.5_.stable6}, {id: cpe:2.3:a:squid:squid:2.5_stable3, title: cpe:2.3:a:squid:squid:2.5_stable3}, {id: cpe:2.3:a:squid:squid:2.5_stable4, title: cpe:2.3:a:squid:squid:2.5_stable4}, {id: cpe:2.3:a:squid:squid:2.5_stable9, title: cpe:2.3:a:squid:squid:2.5_stable9}], vulnerable_configuration_cpe_2_2: [cpe:/a:squid:squid:2.5.6, cpe:/a:squid:squid:2.5.stable1, cpe:/a:squid:squid:2.5.stable2, cpe:/a:squid:squid:2.5.stable3, cpe:/a:squid:squid:2.5.stable4, cpe:/a:squid:squid:2.5.stable5, cpe:/a:squid:squid:2.5.stable6, cpe:/a:squid:squid:2.5.stable7, cpe:/a:squid:squid:2.5_.stable1, cpe:/a:squid:squid:2.5_.stable3, cpe:/a:squid:squid:2.5_.stable4, cpe:/a:squid:squid:2.5_.stable5, cpe:/a:squid:squid:2.5_.stable6, cpe:/a:squid:squid:2.5_stable3, cpe:/a:squid:squid:2.5_stable4, cpe:/a:squid:squid:2.5_stable9]}
