{Modified: 2017-04-17T09:16:04.173000, Published: 2017-04-11T14:59:00.260000, access: {authentication: NONE, complexity: MEDIUM, vector: LOCAL}, capec: [{id: 11, name: Cause Web Server Misclassification, prerequisites: Web server software must rely on file name or file extension for processing., related_weakness: [69, 77], solutions: Implementation: Server routines should be determined by content not determined by filename or file extension., summary: An attack of this type exploits a Web server's decision to take action based on filename or file extension. Because different file types are handled by different server processes, misclassification may force the Web server to take unexpected action, or expected actions in an unexpected sequence. This may cause the server to exhaust resources, supply debug or system data to the attacker, or bind an attacker to a remote process.
This type of vulnerability has been found in many widely used servers including IIS, Lotus Domino, and Orion. The attacker's job in this case is straightforward, standard communication protocols and methods are used and are generally appended with malicious information at the tail end of an otherwise legitimate request. The attack payload varies, but it could be special characters like a period or simply appending a tag that has a special meaning for operations on the server side like .jsp for a java application server. The essence of this attack is that the attacker deceives the server into executing functionality based on the name of the request, i.e. login.jsp, not the contents.}, {id: 136, name: LDAP Injection, prerequisites: The target application must accept a string as user input, fail to sanitize characters that have a special meaning in LDAP queries in the user input, and insert the user-supplied string in an LDAP query which is then processed., related_weakness: [77, 90, 20], solutions: Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as LDAP content.
Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the LDAP or application., summary: An attacker manipulates or crafts an LDAP query for the purpose of undermining the security of the target. Some applications use user input to create LDAP queries that are processed by an LDAP server. For example, a user might provide their username during authentication and the username might be inserted in an LDAP query during the authentication process. An attacker could use this input to inject additional commands into an LDAP query that could disclose sensitive information. For example, entering a * in the aforementioned query might return information about all users on the system. This attack is very similar to an SQL injection attack in that it manipulates a query to gather additional information or coerce a particular return value.}, {id: 15, name: Command Delimiters, prerequisites: Software's input validation or filtering must not detect and block presence of additional malicious command., related_weakness: [146, 77, 184, 78, 185, 93, 140, 157, 138, 154, 697, 713], solutions: Design: Perform whitelist validation against a positive specification for command length, type, and parameters.
Design: Limit program privileges, so if commands circumvent program input validation or filter routines then commands do not running under a privileged account
Implementation: Perform input validation for all remote content.
Implementation: Use type conversions such as JDBC prepared statements., summary: An attack of this type exploits a programs' vulnerabilities that allows an attacker's commands to be concatenated onto a legitimate command with the intent of targeting other resources such as the file system or database. The system that uses a filter or a blacklist input validation, as opposed to whitelist validation is vulnerable to an attacker who predicts delimiters (or combinations of delimiters) not present in the filter or blacklist. As with other injection attacks, the attacker uses the command delimiter payload as an entry point to tunnel through the application and activate additional attacks through SQL queries, shell commands, network scanning, and so on.}, {id: 23, name: File System Function Injection, Content Based, prerequisites: The target software must consume files.
The attacker must have access to modify files that the target software will consume., related_weakness: [77, 23, 22, 713, 715], solutions: Design: Enforce principle of least privilege
Design: Validate all input for content including files. Ensure that if files and remote content must be accepted that once accepted, they are placed in a sandbox type location so that lower assurance clients cannot write up to higher assurance processes (like Web server processes for example)
Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution.
Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host.
Implementation: Virus scanning on host
Implementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin., summary: An attack of this type exploits the host's trust in executing remote content including binary files. The files are poisoned with a malicious payload (targeting the file systems accessible by the target software) by the attacker and may be passed through standard channels such as via email, and standard web content like PDF and multimedia files. The attacker exploits known vulnerabilities or handling routines in the target processes. Vulnerabilities of this type have been found in a wide variety of commercial applications from Microsoft Office to Adobe Acrobat and Apple Safari web browser. When the attacker knows the standard handling routines and can identify vulnerabilities and entry points they can be exploited by otherwise seemingly normal content. Once the attack is executed, the attackers' program can access relative directories such as C:\Program Files or other standard system directories to launch further attacks. In a worst case scenario, these programs are combined with other propagation logic and work as a virus.}, {id: 43, name: Exploiting Multiple Input Interpretation Layers, prerequisites: User input is used to construct a command to be executed on the target system or as part of the file name.
Multiple parser passes are performed on the data supplied by the user., related_weakness: [171, 179, 181, 184, 183, 77, 78, 74, 20, 697, 707], solutions: An iterative approach to input validation may be required to ensure that no dangerous characters are present. It may be necessary to implement redundant checking across different input validation layers. Ensure that invalid data is rejected as soon as possible and do not continue to work with it.
Make sure to perform input validation on canonicalized data (i.e. data that is data in its most standard form). This will help avoid tricky encodings getting past the filters.
Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system., summary: An attacker supplies the target software with input data that contains sequences of special characters designed to bypass input validation logic. This exploit relies on the target making multiples passes over the input data and processing a "layer" of special characters with each pass. In this manner, the attacker can disguise input that would otherwise be rejected as invalid by concealing it with layers of special/escape characters that are stripped off by subsequent processing steps.
The goal is to first discover cases where the input validation layer executes before one or more parsing layers. That is, user input may go through the following logic in an application:
In such cases, the attacker will need to provide input that will pass through the input validator, but after passing through parser2, will be converted into something that the input validator was supposed to stop.}, {id: 6, name: Argument Injection, prerequisites: Target software fails to strip all user-supplied input of any content that could cause the shell to perform unexpected actions.
Software must allow for unvalidated or unfiltered input to be executed on operating system shell, and, optionally, the system configuration must allow for output to be sent back to client., related_weakness: [77, 146, 184, 78, 185, 713, 697], solutions: Design: Do not program input values directly on command shell, instead treat user input as guilty until proven innocent. Build a function that takes user input and converts it to applications specific types and values, stripping or filtering out all unauthorized commands and characters in the process.
Design: Limit program privileges, so if metacharacters or other methods circumvent program input validation routines and shell access is attained then it is not running under a privileged account. chroot jails create a sandbox for the application to execute in, making it more difficult for an attacker to elevate privilege even in the case that a compromise has occurred.
Implementation: Implement an audit log that is written to a separate host, in the event of a compromise the audit log may be able to provide evidence and details of the compromise., summary: An attacker changes the behavior or state of a targeted application through injecting data or command syntax through the targets use of non-validated and non-filtered arguments of exposed services or methods.}, {id: 75, name: Manipulating Writeable Configuration Files, prerequisites: Configuration files must be modifiable by the attacker, related_weakness: [349, 99, 77, 346, 353, 354, 713], solutions: Design: Enforce principle of least privilege
Design: Backup copies of all configuration files
Implementation: Integrity monitoring for configuration files
Implementation: Enforce audit logging on code and configuration promotion procedures.
Implementation: Load configuration from separate process and memory space, for example a separate physical device like a CD, summary: Generally these are manually edited files that are not in the preview of the system administrators, any ability on the attackers' behalf to modify these files, for example in a CVS repository, gives unauthorized access directly to the application, the same as authorized users.}, {id: 76, name: Manipulating Input to File System Calls, prerequisites: Program must allow for user controlled variables to be applied directly to the filesystem, related_weakness: [23, 22, 73, 77, 346, 348, 285, 264, 272, 59, 74, 15, 715], solutions: Design: Enforce principle of least privilege.
Design: Ensure all input is validated, and does not contain file system commands
Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.
Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication.
Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables., summary: An attacker manipulates inputs to the target software which the target software passes to file system calls in the OS. The goal is to gain access to, and perhaps modify, areas of the file system that the target software did not intend to be accessible.}], cvss: 6.9, cvss-time: 2017-04-16T18:52:07.273000, cwe: CWE-77, id: CVE-2016-4445, impact: {availability: COMPLETE, confidentiality: COMPLETE, integrity: COMPLETE}, nessus: [{NASL family: Oracle Linux Local Security Checks, NASL id: ORACLELINUX_ELSA-2016-1267.NASL, description: From Red Hat Security Advisory 2016:1267 :

An update for setroubleshoot and setroubleshoot-plugins is now available for Red Hat Enterprise Linux 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

The setroubleshoot packages provide tools to help diagnose SELinux problems. When Access Vector Cache (AVC) messages are returned, an alert can be generated that provides information about the problem and helps to track its resolution.

The setroubleshoot-plugins package provides a set of analysis plugins for use with setroubleshoot. Each plugin has the capacity to analyze SELinux AVC data and system data to provide user friendly reports describing how to interpret SELinux AVC denials.

Security Fix(es) :

* Shell command injection flaws were found in the way the setroubleshoot executed external commands. A local attacker able to trigger certain SELinux denials could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4445, CVE-2016-4989)

* Shell command injection flaws were found in the way the setroubleshoot allow_execmod and allow_execstack plugins executed external commands. A local attacker able to trigger an execmod or execstack SELinux denial could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4444, CVE-2016-4446)

The CVE-2016-4444 and CVE-2016-4446 issues were discovered by Milos Malik (Red Hat) and the CVE-2016-4445 and CVE-2016-4989 issues were discovered by Red Hat Product Security., last seen: 2019-02-21, modified: 2018-07-25, plugin id: 91737, published: 2016-06-22, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=91737, title: Oracle Linux 6 : setroubleshoot / setroubleshoot-plugins (ELSA-2016-1267)}, {NASL family: Scientific Linux Local Security Checks, NASL id: SL_20160621_SETROUBLESHOOT_AND_SETROUBLESHOOT_PLUGINS_ON_SL6_X.NASL, description: The setroubleshoot-plugins package provides a set of analysis plugins for use with setroubleshoot. Each plugin has the capacity to analyze SELinux AVC data and system data to provide user friendly reports describing how to interpret SELinux AVC denials.

Security Fix(es) :

  - Shell command injection flaws were found in the way the     setroubleshoot executed external commands. A local     attacker able to trigger certain SELinux denials could     use these flaws to execute arbitrary code with root     privileges. (CVE-2016-4445, CVE-2016-4989)

  - Shell command injection flaws were found in the way the     setroubleshoot allow_execmod and allow_execstack plugins     executed external commands. A local attacker able to     trigger an execmod or execstack SELinux denial could use     these flaws to execute arbitrary code with root     privileges. (CVE-2016-4444, CVE-2016-4446)

The CVE-2016-4444 and CVE-2016-4446 issues were discovered by Milos Malik (Red Hat) and the CVE-2016-4445 and CVE-2016-4989 issues were discovered by Red Hat Product Security., last seen: 2019-02-21, modified: 2018-12-28, plugin id: 91806, published: 2016-06-24, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=91806, title: Scientific Linux Security Update : setroubleshoot and setroubleshoot-plugins on SL6.x i386/x86_64}, {NASL family: CentOS Local Security Checks, NASL id: CENTOS_RHSA-2016-1267.NASL, description: An update for setroubleshoot and setroubleshoot-plugins is now available for Red Hat Enterprise Linux 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

The setroubleshoot packages provide tools to help diagnose SELinux problems. When Access Vector Cache (AVC) messages are returned, an alert can be generated that provides information about the problem and helps to track its resolution.

The setroubleshoot-plugins package provides a set of analysis plugins for use with setroubleshoot. Each plugin has the capacity to analyze SELinux AVC data and system data to provide user friendly reports describing how to interpret SELinux AVC denials.

Security Fix(es) :

* Shell command injection flaws were found in the way the setroubleshoot executed external commands. A local attacker able to trigger certain SELinux denials could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4445, CVE-2016-4989)

* Shell command injection flaws were found in the way the setroubleshoot allow_execmod and allow_execstack plugins executed external commands. A local attacker able to trigger an execmod or execstack SELinux denial could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4444, CVE-2016-4446)

The CVE-2016-4444 and CVE-2016-4446 issues were discovered by Milos Malik (Red Hat) and the CVE-2016-4445 and CVE-2016-4989 issues were discovered by Red Hat Product Security., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 91732, published: 2016-06-22, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=91732, title: CentOS 6 : setroubleshoot / setroubleshoot-plugins (CESA-2016:1267)}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2016-1267.NASL, description: An update for setroubleshoot and setroubleshoot-plugins is now available for Red Hat Enterprise Linux 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

The setroubleshoot packages provide tools to help diagnose SELinux problems. When Access Vector Cache (AVC) messages are returned, an alert can be generated that provides information about the problem and helps to track its resolution.

The setroubleshoot-plugins package provides a set of analysis plugins for use with setroubleshoot. Each plugin has the capacity to analyze SELinux AVC data and system data to provide user friendly reports describing how to interpret SELinux AVC denials.

Security Fix(es) :

* Shell command injection flaws were found in the way the setroubleshoot executed external commands. A local attacker able to trigger certain SELinux denials could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4445, CVE-2016-4989)

* Shell command injection flaws were found in the way the setroubleshoot allow_execmod and allow_execstack plugins executed external commands. A local attacker able to trigger an execmod or execstack SELinux denial could use these flaws to execute arbitrary code with root privileges. (CVE-2016-4444, CVE-2016-4446)

The CVE-2016-4444 and CVE-2016-4446 issues were discovered by Milos Malik (Red Hat) and the CVE-2016-4445 and CVE-2016-4989 issues were discovered by Red Hat Product Security., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 91757, published: 2016-06-22, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=91757, title: RHEL 6 : setroubleshoot and setroubleshoot-plugins (RHSA-2016:1267)}], ranking: [[{circl: 3}]], redhat: {advisories: [{bugzilla: {id: 1163346, title: [RFE] provide the policy version in Bugzilla bug reports}, oval: {AND: [{OR: [{comment: Red Hat Enterprise Linux 7 Client is installed, oval: oval:com.redhat.rhba:tst:20150364001}, {comment: Red Hat Enterprise Linux 7 Server is installed, oval: oval:com.redhat.rhba:tst:20150364002}, {comment: Red Hat Enterprise Linux 7 Workstation is installed, oval: oval:com.redhat.rhba:tst:20150364003}, {comment: Red Hat Enterprise Linux 7 ComputeNode is installed, oval: oval:com.redhat.rhba:tst:20150364004}]}, {OR: [{AND: [{comment: setroubleshoot is earlier than 0:3.2.24-1.1.el7, oval: oval:com.redhat.rhba:tst:20152287007}, {comment: setroubleshoot is signed with Red Hat redhatrelease2 key, oval: oval:com.redhat.rhba:tst:20152287008}]}, {AND: [{comment: setroubleshoot-server is earlier than 0:3.2.24-1.1.el7, oval: oval:com.redhat.rhba:tst:20152287005}, {comment: setroubleshoot-server is signed with Red Hat redhatrelease2 key, oval: oval:com.redhat.rhba:tst:20152287006}]}]}]}, rhsa: {released: 2015-11-19, severity: None, title: RHBA-2015:2287: setroubleshoot bug fix and enhancement update (None)}}, {rhsa: {id: RHSA-2016:1267}}], rpms: [setroubleshoot-0:3.2.24-1.1.el7, setroubleshoot-server-0:3.2.24-1.1.el7, setroubleshoot-plugins-0:3.0.40-3.1.el6_8, setroubleshoot-0:3.0.47-12.el6_8, setroubleshoot-doc-0:3.0.47-12.el6_8, setroubleshoot-server-0:3.0.47-12.el6_8]}, references: [http://seclists.org/oss-sec/2016/q2/575, http://www.securityfocus.com/bid/91430, http://www.securitytracker.com/id/1036144, https://bugzilla.redhat.com/show_bug.cgi?id=1339183, https://github.com/fedora-selinux/setroubleshoot/commit/2d12677629ca319310f6263688bb1b7f676c01b7, https://rhn.redhat.com/errata/RHSA-2016-1267.html], refmap: {bid: [91430], confirm: [https://bugzilla.redhat.com/show_bug.cgi?id=1339183, https://github.com/fedora-selinux/setroubleshoot/commit/2d12677629ca319310f6263688bb1b7f676c01b7], mlist: [[oss-security] 20160621 Re: SELinux troubles], sectrack: [1036144]}, summary: The fix_lookup_id function in sealert in setroubleshoot before 3.2.23 allows local users to execute arbitrary commands as root by triggering an SELinux denial with a crafted file name, related to executing external commands with the commands.getstatusoutput function., vulnerable_configuration: [{id: cpe:2.3:a:setroubleshoot_project:setroubleshoot:3.2.22, title: cpe:2.3:a:setroubleshoot_project:setroubleshoot:3.2.22}, {id: cpe:2.3:o:redhat:enterprise_linux_desktop:7.0, title: RedHat Enterprise Linux Desktop 7.0}, {id: cpe:2.3:o:redhat:enterprise_linux_hpc_node:7.0, title: RedHat Enterprise Linux HPC Node 7.0}, {id: cpe:2.3:o:redhat:enterprise_linux_server:7.0, title: RedHat Enterprise Linux Server 7.0}, {id: cpe:2.3:o:redhat:enterprise_linux_workstation:7.0, title: RedHat Enterprise Linux Workstation 7.0}], vulnerable_configuration_cpe_2_2: [cpe:/a:setroubleshoot_project:setroubleshoot:3.2.22, cpe:/o:redhat:enterprise_linux_desktop:7.0, cpe:/o:redhat:enterprise_linux_hpc_node:7.0, cpe:/o:redhat:enterprise_linux_server:7.0, cpe:/o:redhat:enterprise_linux_workstation:7.0]}
