{Modified: 2017-01-06T21:59:15.293000, Published: 2014-03-31T10:58:15.397000, access: {authentication: SINGLE_INSTANCE, complexity: MEDIUM, vector: NETWORK}, capec: [{id: 26, name: Leveraging Race Conditions, prerequisites: A resource is accessed/modified concurrently by multiple processes such that a race condition exists.
The attacker has the ability to modify the resource., related_weakness: [368, 363, 366, 370, 362, 662, 689, 667, 665], solutions: Use safe libraries to access resources such as files.
Be aware that improper use of access function calls such as chown(), tempfile(), chmod(), etc. can cause a race condition.
Use synchronization to control the flow of execution.
Use static analysis tools to find race conditions.
Pay attention to concurrency problems related to the access of resources., summary: This attack targets a race condition occurring when multiple processes access and manipulate the same resource concurrently and the outcome of the execution depends on the particular order in which the access takes place. The attacker can leverage a race condition by "running the race", modifying the resource and modifying the normal execution flow. For instance a race condition can occur while accessing a file, the attacker can trick the system by replacing the original file with his version and cause the system to read the malicious file.}, {id: 29, name: Leveraging Time-of-Check and Time-of-Use (TOCTOU) Race Conditions, prerequisites: A resource is access/modified concurrently by multiple processes.
The attacker is able to modify resource.
A race condition exists while accessing a resource., related_weakness: [367, 368, 366, 370, 362, 662, 691, 663, 665], solutions: Use safe libraries to access resources such as files.
Be aware that improper use of access function calls such as chown(), tempfile(), chmod(), etc. can cause a race condition.
Use synchronization to control the flow of execution.
Use static analysis tools to find race conditions.
Pay attention to concurrency problems related to the access of resources., summary: This attack targets a race condition occurring between the time of check (state) for a resource and the time of use of a resource. The typical example is the file access. The attacker can leverage a file access race condition by "running the race", meaning that he would modify the resource between the first time the target program accesses the file and the time the target program uses the file. During that period of time, the attacker could do something such as replace the file and cause an escalation of privilege.}], cvss: 4.9, cvss-time: 2014-03-31T13:54:55.317000, cwe: CWE-362, id: CVE-2014-0062, impact: {availability: NONE, confidentiality: PARTIAL, integrity: PARTIAL}, last-modified: 2017-12-15T21:29:01.697000, nessus: [{NASL family: MacOS X Local Security Checks, NASL id: MACOSX_SERVER_4_0.NASL, description: The remote Mac OS X host has a version of OS X Server installed that is prior to version 4.0.  It is, therefore, affected by the following vulnerabilities :

  - There are multiple vulnerabilities within the included     BIND, the most serious of which can lead to a denial of     service. (CVE-2013-3919, CVE-2013-4854, CVE-2014-0591)

  - There are multiple vulnerabilities within the included     LibYAML for the Profile Manager and ServerRuby, the most     serious of which can lead to arbitrary code execution.
    (CVE-2013-4164, CVE-2013-6393)

  - There are multiple vulnerabilities within the included     PostgreSQL, the most serious of which can lead to     arbitrary code execution. (CVE-2014-0060, CVE-2014-0061,     CVE-2014-0062, CVE-2014-0063, CVE-2014-0064,     CVE-2014-0065, CVE-2014-0066)

  - An error exists related to the way SSL 3.0 handles     padding bytes when decrypting messages encrypted using     block ciphers in cipher block chaining (CBC) mode. A     man-in-the-middle attacker can decrypt a selected byte     of a cipher text in as few as 256 tries if they are able     to force a victim application to repeatedly send the     same data over newly created SSL 3.0 connections. This     is also known as the 'POODLE' issue. (CVE-2014-3566)

  - A cross-site scripting flaw exists in the Xcode Server     due to not properly validating input before returning it     to the user. This can allow a remote attacker, using a     specially crafted request, to execute code within the     browser / server trust relationship. (CVE-2014-4406)

  - A SQL injection flaw exists in the Wiki Server due to     not properly sanitizing user input before using it in     SQL queries. This can allow a remote attacker, using a     specially crafted request, to inject or manipulate SQL     queries, thus allowing the manipulation or disclosure     of arbitrary data. (CVE-2014-4424)

  - A restriction bypass flaw exists in the Mail Server due     to SCAL changes being cached and not enforced until the     service had restarted. This can allow an authenticated     remote attacker to bypass those restrictions.
    (CVE-2014-4446)

  - A password disclosure flaw exists in the Profile Manager     due to passwords being potentially saved to a file when     editing or setting up a profile. This can allow a local     attacker to gain access to password information.
    (CVE-2014-4447), last seen: 2019-02-21, modified: 2018-07-14, plugin id: 78601, published: 2014-10-21, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=78601, title: Mac OS X : OS X Server < 4.0 Multiple Vulnerabilities (POODLE)}, {NASL family: Gentoo Local Security Checks, NASL id: GENTOO_GLSA-201408-15.NASL, description: The remote host is affected by the vulnerability described in GLSA-201408-15 (PostgreSQL: Multiple vulnerabilities)

    Multiple vulnerabilities have been discovered in PostgreSQL. Please       review the CVE identifiers referenced below for details.
  Impact :

    A remote authenticated attacker may be able to create a Denial of       Service condition, bypass security restrictions, or have other       unspecified impact.
  Workaround :

    There is no known workaround at this time., last seen: 2019-02-21, modified: 2018-07-12, plugin id: 77459, published: 2014-08-30, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=77459, title: GLSA-201408-15 : PostgreSQL: Multiple vulnerabilities}, {NASL family: Mandriva Local Security Checks, NASL id: MANDRIVA_MDVSA-2015-110.NASL, description: Updated postgresql packages fix multiple security vulnerabilities :

Granting a role without ADMIN OPTION is supposed to prevent the grantee from adding or removing members from the granted role, but this restriction was easily bypassed by doing SET ROLE first. The security impact is mostly that a role member can revoke the access of others, contrary to the wishes of his grantor. Unapproved role member additions are a lesser concern, since an uncooperative role member could provide most of his rights to others anyway by creating views or SECURITY DEFINER functions (CVE-2014-0060).

The primary role of PL validator functions is to be called implicitly during CREATE FUNCTION, but they are also normal SQL functions that a user can call explicitly. Calling a validator on a function actually written in some other language was not checked for and could be exploited for privilege-escalation purposes. The fix involves adding a call to a privilege-checking function in each validator function.
Non-core procedural languages will also need to make this change to their own validator functions, if any (CVE-2014-0061).

If the name lookups come to different conclusions due to concurrent activity, we might perform some parts of the DDL on a different table than other parts. At least in the case of CREATE INDEX, this can be used to cause the permissions checks to be performed against a different table than the index creation, allowing for a privilege escalation attack (CVE-2014-0062).

The MAXDATELEN constant was too small for the longest possible value of type interval, allowing a buffer overrun in interval_out().
Although the datetime input functions were more careful about avoiding buffer overrun, the limit was short enough to cause them to reject some valid inputs, such as input containing a very long timezone name.
The ecpg library contained these vulnerabilities along with some of its own (CVE-2014-0063).

Several functions, mostly type input functions, calculated an allocation size without checking for overflow. If overflow did occur, a too-small buffer would be allocated and then written past (CVE-2014-0064).

Use strlcpy() and related functions to provide a clear guarantee that fixed-size buffers are not overrun. Unlike the preceding items, it is unclear whether these cases really represent live issues, since in most cases there appear to be previous constraints on the size of the input string. Nonetheless it seems prudent to silence all Coverity warnings of this type (CVE-2014-0065).

There are relatively few scenarios in which crypt() could return NULL, but contrib/chkpass would crash if it did. One practical case in which this could be an issue is if libc is configured to refuse to execute unapproved hashing algorithms (e.g., FIPS mode) (CVE-2014-0066).

Since the temporary server started by make check uses trust authentication, another user on the same machine could connect to it as database superuser, and then potentially exploit the privileges of the operating-system user who started the tests. A future release will probably incorporate changes in the testing procedure to prevent this risk, but some public discussion is needed first. So for the moment, just warn people against using make check when there are untrusted users on the same machine (CVE-2014-0067).

A user with limited clearance on a table might have access to information in columns without SELECT rights on through server error messages (CVE-2014-8161).

The function to_char() might read/write past the end of a buffer. This might crash the server when a formatting template is processed (CVE-2015-0241).

The pgcrypto module is vulnerable to stack buffer overrun that might crash the server (CVE-2015-0243).

Emil Lenngren reported that an attacker can inject SQL commands when the synchronization between client and server is lost (CVE-2015-0244).

This update provides PostgreSQL versions 9.3.6 and 9.2.10 that fix these issues, as well as several others., last seen: 2019-02-21, modified: 2018-07-19, plugin id: 82363, published: 2015-03-30, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=82363, title: Mandriva Linux Security Advisory : postgresql (MDVSA-2015:110)}, {NASL family: Oracle Linux Local Security Checks, NASL id: ORACLELINUX_ELSA-2014-0211.NASL, description: From Red Hat Security Advisory 2014:0211 :

Updated postgresql84 and postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5 and 6 respectively.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

These updated packages upgrade PostgreSQL to version 8.4.20, which fixes these issues as well as several non-security issues. Refer to the PostgreSQL Release Notes for a full list of changes :

http://www.postgresql.org/docs/8.4/static/release-8-4-19.html http://www.postgresql.org/docs/8.4/static/release-8-4-20.html

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-07-18, plugin id: 72697, published: 2014-02-26, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72697, title: Oracle Linux 5 / 6 : postgresql / postgresql84 (ELSA-2014-0211)}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2014-0249.NASL, description: Updated postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72810, published: 2014-03-05, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72810, title: RHEL 5 : postgresql (RHSA-2014:0249)}, {NASL family: Amazon Linux Local Security Checks, NASL id: ALA_ALAS-2014-306.NASL, description: Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066), last seen: 2019-02-21, modified: 2018-04-18, plugin id: 73060, published: 2014-03-18, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=73060, title: Amazon Linux AMI : postgresql9 (ALAS-2014-306)}, {NASL family: Ubuntu Local Security Checks, NASL id: UBUNTU_USN-2120-1.NASL, description: Noah Misch and Jonas Sundman discovered that PostgreSQL did not correctly enforce ADMIN OPTION restrictions. An authenticated attacker could use this issue to possibly revoke access from others, contrary to expected permissions. (CVE-2014-0060)

Andres Freund discovered that PostgreSQL incorrectly handled validator functions. An authenticated attacker could possibly use this issue to escalate their privileges. (CVE-2014-0061)

Andres Freund discovered that PostgreSQL incorrectly handled concurrent CREATE INDEX statements. An authenticated attacker could possibly use this issue to obtain access to restricted data, bypassing intended privileges. (CVE-2014-0062)

Daniel Schussler discovered that PostgreSQL incorrectly handled datetime input. An authenticated attacker could possibly use this issue to cause PostgreSQL to crash, resulting in a denial of service, or possibly execute arbitrary code. (CVE-2014-0063)

It was discovered that PostgreSQL incorrectly handled certain size calculations. An authenticated attacker could possibly use this issue to cause PostgreSQL to crash, resulting in a denial of service, or possibly execute arbitrary code. (CVE-2014-0064)

Peter Eisentraut and Jozef Mlich discovered that PostgreSQL incorrectly handled certain buffer sizes. An authenticated attacker could possibly use this issue to cause PostgreSQL to crash, resulting in a denial of service, or possibly execute arbitrary code.
(CVE-2014-0065)

Honza Horak discovered that PostgreSQL incorrectly used the crypt() library function. This issue could possibly cause PostgreSQL to crash, resulting in a denial of service (CVE-2014-0066).

Note that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues., last seen: 2019-02-21, modified: 2018-12-01, plugin id: 72682, published: 2014-02-25, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72682, title: Ubuntu 10.04 LTS / 12.04 LTS / 12.10 / 13.10 : postgresql-8.4, postgresql-9.1 vulnerabilities (USN-2120-1)}, {NASL family: Scientific Linux Local Security Checks, NASL id: SL_20140304_POSTGRESQL_ON_SL5_X.NASL, description: Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-12-28, plugin id: 72811, published: 2014-03-05, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72811, title: Scientific Linux Security Update : postgresql on SL5.x i386/x86_64}, {NASL family: Scientific Linux Local Security Checks, NASL id: SL_20140225_POSTGRESQL84_AND_POSTGRESQL_ON_SL5_X.NASL, description: Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

These updated packages upgrade PostgreSQL to version 8.4.20, which fixes these issues as well as several non-security issues. Refer to the PostgreSQL Release Notes for a full list of changes :

http://www.postgresql.org/docs/8.4/static/release-8-4-19.html http://www.postgresql.org/docs/8.4/static/release-8-4-20.html

If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-12-28, plugin id: 72699, published: 2014-02-26, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72699, title: Scientific Linux Security Update : postgresql84 and postgresql on SL5.x, SL6.x i386/x86_64}, {NASL family: FreeBSD Local Security Checks, NASL id: FREEBSD_PKG_42D420909A4D11E3B02908002798F6FF.NASL, description: PostgreSQL Project reports :

This update fixes CVE-2014-0060, in which PostgreSQL did not properly enforce the WITH ADMIN OPTION permission for ROLE management. Before this fix, any member of a ROLE was able to grant others access to the same ROLE regardless if the member was given the WITH ADMIN OPTION permission. It also fixes multiple privilege escalation issues, including: CVE-2014-0061, CVE-2014-0062, CVE-2014-0063, CVE-2014-0064, CVE-2014-0065, and CVE-2014-0066. More information on these issues can be found on our security page and the security issue detail wiki page.

With this release, we are also alerting users to a known security hole that allows other users on the same machine to gain access to an operating system account while it is doing 'make check' :
CVE-2014-0067. 'Make check' is normally part of building PostgreSQL from source code. As it is not possible to fix this issue without causing significant issues to our testing infrastructure, a patch will be released separately and publicly. Until then, users are strongly advised not to run 'make check' on machines where untrusted users have accounts., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72612, published: 2014-02-21, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72612, title: FreeBSD : PostgreSQL -- multiple privilege issues (42d42090-9a4d-11e3-b029-08002798f6ff)}, {NASL family: CentOS Local Security Checks, NASL id: CENTOS_RHSA-2014-0221.NASL, description: The remote CentOS host is missing a security update which has been documented in Red Hat advisory RHSA-2014:0221., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72865, published: 2014-03-07, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72865, title: CentOS 6 : postgresql92-postgresql (CESA-2014:0221)}, {NASL family: Debian Local Security Checks, NASL id: DEBIAN_DSA-2864.NASL, description: Various vulnerabilities were discovered in PostgreSQL :

  - CVE-2014-0060 Shore up GRANT ... WITH ADMIN OPTION     restrictions (Noah Misch)     Granting a role without ADMIN OPTION is supposed to     prevent the grantee from adding or removing members from     the granted role, but this restriction was easily     bypassed by doing SET ROLE first. The security impact is     mostly that a role member can revoke the access of     others, contrary to the wishes of his grantor.
    Unapproved role member additions are a lesser concern,     since an uncooperative role member could provide most of     his rights to others anyway by creating views or     SECURITY DEFINER functions.

  - CVE-2014-0061 Prevent privilege escalation via manual     calls to PL validator functions (Andres Freund)

    The primary role of PL validator functions is to be     called implicitly during CREATE FUNCTION, but they are     also normal SQL functions that a user can call     explicitly. Calling a validator on a function actually     written in some other language was not checked for and     could be exploited for privilege-escalation purposes.
    The fix involves adding a call to a privilege-checking     function in each validator function. Non-core procedural     languages will also need to make this change to their     own validator functions, if any.

  - CVE-2014-0062 Avoid multiple name lookups during table     and index DDL (Robert Haas, Andres Freund)

    If the name lookups come to different conclusions due to     concurrent activity, we might perform some parts of the     DDL on a different table than other parts. At least in     the case of CREATE INDEX, this can be used to cause the     permissions checks to be performed against a different     table than the index creation, allowing for a privilege     escalation attack.

  - CVE-2014-0063 Prevent buffer overrun with long datetime     strings (Noah Misch)

    The MAXDATELEN constant was too small for the longest     possible value of type interval, allowing a buffer     overrun in interval_out(). Although the datetime input     functions were more careful about avoiding buffer     overrun, the limit was short enough to cause them to     reject some valid inputs, such as input containing a     very long timezone name. The ecpg library contained     these vulnerabilities along with some of its own.

  - CVE-2014-0064 Prevent buffer overrun due to integer     overflow in size calculations (Noah Misch, Heikki     Linnakangas)

    Several functions, mostly type input functions,     calculated an allocation size without checking for     overflow. If overflow did occur, a too-small buffer     would be allocated and then written past.

  - CVE-2014-0065 Prevent overruns of fixed-size buffers     (Peter Eisentraut, Jozef Mlich)

    Use strlcpy() and related functions to provide a clear     guarantee that fixed-size buffers are not overrun.
    Unlike the preceding items, it is unclear whether these     cases really represent live issues, since in most cases     there appear to be previous constraints on the size of     the input string. Nonetheless it seems prudent to     silence all Coverity warnings of this type.

  - CVE-2014-0066 Avoid crashing if crypt() returns NULL     (Honza Horak, Bruce Momjian)

    There are relatively few scenarios in which crypt()     could return NULL, but contrib/chkpass would crash if it     did. One practical case in which this could be an issue     is if libc is configured to refuse to execute unapproved     hashing algorithms (e.g., 'FIPS mode').

  - CVE-2014-0067 Document risks of make check in the     regression testing instructions (Noah Misch, Tom Lane)

    Since the temporary server started by make check uses     'trust' authentication, another user on the same machine     could connect to it as database superuser, and then     potentially exploit the privileges of the     operating-system user who started the tests. A future     release will probably incorporate changes in the testing     procedure to prevent this risk, but some public     discussion is needed first. So for the moment, just warn     people against using make check when there are untrusted     users on the same machine., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72610, published: 2014-02-21, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72610, title: Debian DSA-2864-1 : postgresql-8.4 - several vulnerabilities}, {NASL family: CentOS Local Security Checks, NASL id: CENTOS_RHSA-2014-0249.NASL, description: Updated postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72805, published: 2014-03-05, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72805, title: CentOS 5 : postgresql (CESA-2014:0249)}, {NASL family: CentOS Local Security Checks, NASL id: CENTOS_RHSA-2014-0211.NASL, description: Updated postgresql84 and postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5 and 6 respectively.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

These updated packages upgrade PostgreSQL to version 8.4.20, which fixes these issues as well as several non-security issues. Refer to the PostgreSQL Release Notes for a full list of changes :

http://www.postgresql.org/docs/8.4/static/release-8-4-19.html http://www.postgresql.org/docs/8.4/static/release-8-4-20.html

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72694, published: 2014-02-26, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72694, title: CentOS 5 / 6 : postgresql / postgresql84 (CESA-2014:0211)}, {NASL family: SuSE Local Security Checks, NASL id: SUSE_11_LIBECPG6-140303.NASL, description: The PostgreSQL database server was updated to version 9.1.12 to fix various security issues :

  - Granting a role without ADMIN OPTION is supposed to     prevent the grantee from adding or removing members from     the granted role, but this restriction was easily     bypassed by doing SET ROLE first. The security impact is     mostly that a role member can revoke the access of     others, contrary to the wishes of his grantor.
    Unapproved role member additions are a lesser concern,     since an uncooperative role member could provide most of     his rights to others anyway by creating views or     SECURITY DEFINER functions. (CVE-2014-0060)

  - The primary role of PL validator functions is to be     called implicitly during CREATE FUNCTION, but they are     also normal SQL functions that a user can call     explicitly. Calling a validator on a function actually     written in some other language was not checked for and     could be exploited for privilege-escalation purposes.
    The fix involves adding a call to a privilege-checking     function in each validator function. Non-core procedural     languages will also need to make this change to their     own validator functions, if any. (CVE-2014-0061)

  - If the name lookups come to different conclusions due to     concurrent activity, we might perform some parts of the     DDL on a different table than other parts. At least in     the case of CREATE INDEX, this can be used to cause the     permissions checks to be performed against a different     table than the index creation, allowing for a privilege     escalation attack. (CVE-2014-0062)

  - The MAXDATELEN constant was too small for the longest     possible value of type interval, allowing a buffer     overrun in interval_out(). Although the datetime input     functions were more careful about avoiding buffer     overrun, the limit was short enough to cause them to     reject some valid inputs, such as input containing a     very long timezone name. The ecpg library contained     these vulnerabilities along with some of its own.
    (CVE-2014-0063)

  - Several functions, mostly type input functions,     calculated an allocation size without checking for     overflow. If overflow did occur, a too-small buffer     would be allocated and then written past.
    (CVE-2014-0064)

  - Use strlcpy() and related functions to provide a clear     guarantee that fixed-size buffers are not overrun.
    Unlike the preceding items, it is unclear whether these     cases really represent live issues, since in most cases     there appear to be previous constraints on the size of     the input string. Nonetheless it seems prudent to     silence all Coverity warnings of this type.
    (CVE-2014-0065)

  - There are relatively few scenarios in which crypt()     could return NULL, but contrib/chkpass would crash if it     did. One practical case in which this could be an issue     is if libc is configured to refuse to execute unapproved     hashing algorithms (e.g., 'FIPS mode'). (CVE-2014-0066)

  - Since the temporary server started by make check uses     'trust' authentication, another user on the same machine     could connect to it as database superuser, and then     potentially exploit the privileges of the     operating-system user who started the tests. A future     release will probably incorporate changes in the testing     procedure to prevent this risk, but some public     discussion is needed first. So for the moment, just warn     people against using make check when there are untrusted     users on the same machine. (CVE-2014-0067)

The complete list of bugs and more information can be found at:
http://www.postgresql.org/docs/9.1/static/release-9-1-12.html, last seen: 2019-02-21, modified: 2015-02-18, plugin id: 73268, published: 2014-03-31, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=73268, title: SuSE 11.3 Security Update : PostgreSQL 9.1 (SAT Patch Number 8970)}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2014-0211.NASL, description: Updated postgresql84 and postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5 and 6 respectively.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

These updated packages upgrade PostgreSQL to version 8.4.20, which fixes these issues as well as several non-security issues. Refer to the PostgreSQL Release Notes for a full list of changes :

http://www.postgresql.org/docs/8.4/static/release-8-4-19.html http://www.postgresql.org/docs/8.4/static/release-8-4-20.html

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-12-20, plugin id: 72698, published: 2014-02-26, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72698, title: RHEL 5 / 6 : postgresql84 and postgresql (RHSA-2014:0211)}, {NASL family: MacOS X Local Security Checks, NASL id: MACOSX_SERVER_3_2_1.NASL, description: The remote Mac OS X 10.9 host has a version of OS X Server installed that is prior to version 3.2.1. It is, therefore, affected by the following vulnerabilities :

  - Multiple vulnerabilities exist within the included     PostgreSQL, the more serious of these allow remote code     execution or denial of service. (CVE-2014-0060,     CVE-2014-0061, CVE-2014-0062, CVE-2014-0063,     CVE-2014-0064, CVE-2014-0065, CVE-2014-0066)

  - A cross-site scripting vulnerability exists within the     Xcode Server. Using a specially crafted website, a     remote attacker can exploit this to execute arbitrary     code within the server / browser trust relationship.
    (CVE-2014-4406)

  - A SQL injection vulnerability exists in the Wiki Server     due to the improper validation of SQL queries. A remote     attacker can exploit this to inject or manipulate SQL     queries on the back-end database. (CVE-2014-4424), last seen: 2019-02-21, modified: 2018-07-14, plugin id: 77758, published: 2014-09-19, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=77758, title: Mac OS X : OS X Server < 3.2.1 Multiple Vulnerabilities}, {NASL family: Debian Local Security Checks, NASL id: DEBIAN_DSA-2865.NASL, description: Various vulnerabilities were discovered in PostgreSQL :

  - CVE-2014-0060 Shore up GRANT ... WITH ADMIN OPTION     restrictions (Noah Misch)     Granting a role without ADMIN OPTION is supposed to     prevent the grantee from adding or removing members from     the granted role, but this restriction was easily     bypassed by doing SET ROLE first. The security impact is     mostly that a role member can revoke the access of     others, contrary to the wishes of his grantor.
    Unapproved role member additions are a lesser concern,     since an uncooperative role member could provide most of     his rights to others anyway by creating views or     SECURITY DEFINER functions.

  - CVE-2014-0061 Prevent privilege escalation via manual     calls to PL validator functions (Andres Freund)

    The primary role of PL validator functions is to be     called implicitly during CREATE FUNCTION, but they are     also normal SQL functions that a user can call     explicitly. Calling a validator on a function actually     written in some other language was not checked for and     could be exploited for privilege-escalation purposes.
    The fix involves adding a call to a privilege-checking     function in each validator function. Non-core procedural     languages will also need to make this change to their     own validator functions, if any.

  - CVE-2014-0062 Avoid multiple name lookups during table     and index DDL (Robert Haas, Andres Freund)

    If the name lookups come to different conclusions due to     concurrent activity, we might perform some parts of the     DDL on a different table than other parts. At least in     the case of CREATE INDEX, this can be used to cause the     permissions checks to be performed against a different     table than the index creation, allowing for a privilege     escalation attack.

  - CVE-2014-0063 Prevent buffer overrun with long datetime     strings (Noah Misch)

    The MAXDATELEN constant was too small for the longest     possible value of type interval, allowing a buffer     overrun in interval_out(). Although the datetime input     functions were more careful about avoiding buffer     overrun, the limit was short enough to cause them to     reject some valid inputs, such as input containing a     very long timezone name. The ecpg library contained     these vulnerabilities along with some of its own.

  - CVE-2014-0064 CVE-2014-2669 Prevent buffer overrun due     to integer overflow in size calculations (Noah Misch,     Heikki Linnakangas)

    Several functions, mostly type input functions,     calculated an allocation size without checking for     overflow. If overflow did occur, a too-small buffer     would be allocated and then written past.

  - CVE-2014-0065 Prevent overruns of fixed-size buffers     (Peter Eisentraut, Jozef Mlich)

    Use strlcpy() and related functions to provide a clear     guarantee that fixed-size buffers are not overrun.
    Unlike the preceding items, it is unclear whether these     cases really represent live issues, since in most cases     there appear to be previous constraints on the size of     the input string. Nonetheless it seems prudent to     silence all Coverity warnings of this type.

  - CVE-2014-0066 Avoid crashing if crypt() returns NULL     (Honza Horak, Bruce Momjian)

    There are relatively few scenarios in which crypt()     could return NULL, but contrib/chkpass would crash if it     did. One practical case in which this could be an issue     is if libc is configured to refuse to execute unapproved     hashing algorithms (e.g., 'FIPS mode').

  - CVE-2014-0067 Document risks of make check in the     regression testing instructions (Noah Misch, Tom Lane)

    Since the temporary server started by make check uses     'trust' authentication, another user on the same machine     could connect to it as database superuser, and then     potentially exploit the privileges of the     operating-system user who started the tests. A future     release will probably incorporate changes in the testing     procedure to prevent this risk, but some public     discussion is needed first. So for the moment, just warn     people against using make check when there are untrusted     users on the same machine., last seen: 2019-02-21, modified: 2018-11-10, plugin id: 72611, published: 2014-02-21, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72611, title: Debian DSA-2865-1 : postgresql-9.1 - several vulnerabilities}, {NASL family: Oracle Linux Local Security Checks, NASL id: ORACLELINUX_ELSA-2014-0249.NASL, description: From Red Hat Security Advisory 2014:0249 :

Updated postgresql packages that fix multiple security issues are now available for Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having Important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.

PostgreSQL is an advanced object-relational database management system (DBMS).

Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066)

Red Hat would like to thank the PostgreSQL project for reporting these issues. Upstream acknowledges Noah Misch as the original reporter of CVE-2014-0060 and CVE-2014-0063, Heikki Linnakangas and Noah Misch as the original reporters of CVE-2014-0064, Peter Eisentraut and Jozef Mlich as the original reporters of CVE-2014-0065, Andres Freund as the original reporter of CVE-2014-0061, Robert Haas and Andres Freund as the original reporters of CVE-2014-0062, and Honza Horak and Bruce Momjian as the original reporters of CVE-2014-0066.

All PostgreSQL users are advised to upgrade to these updated packages, which contain backported patches to correct these issues. If the postgresql service is running, it will be automatically restarted after installing this update., last seen: 2019-02-21, modified: 2018-07-18, plugin id: 72809, published: 2014-03-05, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72809, title: Oracle Linux 5 : postgresql (ELSA-2014-0249)}, {NASL family: Mandriva Local Security Checks, NASL id: MANDRIVA_MDVSA-2014-047.NASL, description: Multiple vulnerabilities has been discovered and corrected in postgresql :

Granting a role without ADMIN OPTION is supposed to prevent the grantee from adding or removing members from the granted role, but this restriction was easily bypassed by doing SET ROLE first. The security impact is mostly that a role member can revoke the access of others, contrary to the wishes of his grantor. Unapproved role member additions are a lesser concern, since an uncooperative role member could provide most of his rights to others anyway by creating views or SECURITY DEFINER functions (CVE-2014-0060).

The primary role of PL validator functions is to be called implicitly during CREATE FUNCTION, but they are also normal SQL functions that a user can call explicitly. Calling a validator on a function actually written in some other language was not checked for and could be exploited for privilege-escalation purposes. The fix involves adding a call to a privilege-checking function in each validator function.
Non-core procedural languages will also need to make this change to their own validator functions, if any (CVE-2014-0061).

If the name lookups come to different conclusions due to concurrent activity, we might perform some parts of the DDL on a different table than other parts. At least in the case of CREATE INDEX, this can be used to cause the permissions checks to be performed against a different table than the index creation, allowing for a privilege escalation attack (CVE-2014-0062).

The MAXDATELEN constant was too small for the longest possible value of type interval, allowing a buffer overrun in interval_out().
Although the datetime input functions were more careful about avoiding buffer overrun, the limit was short enough to cause them to reject some valid inputs, such as input containing a very long timezone name.
The ecpg library contained these vulnerabilities along with some of its own (CVE-2014-0063).

Several functions, mostly type input functions, calculated an allocation size without checking for overflow. If overflow did occur, a too-small buffer would be allocated and then written past (CVE-2014-0064).

Use strlcpy() and related functions to provide a clear guarantee that fixed-size buffers are not overrun. Unlike the preceding items, it is unclear whether these cases really represent live issues, since in most cases there appear to be previous constraints on the size of the input string. Nonetheless it seems prudent to silence all Coverity warnings of this type (CVE-2014-0065).

There are relatively few scenarios in which crypt() could return NULL, but contrib/chkpass would crash if it did. One practical case in which this could be an issue is if libc is configured to refuse to execute unapproved hashing algorithms (e.g., FIPS mode) (CVE-2014-0066).

Since the temporary server started by make check uses trust authentication, another user on the same machine could connect to it as database superuser, and then potentially exploit the privileges of the operating-system user who started the tests. A future release will probably incorporate changes in the testing procedure to prevent this risk, but some public discussion is needed first. So for the moment, just warn people against using make check when there are untrusted users on the same machine (CVE-2014-0067).

This advisory provides the latest version of PostgreSQL that is not vulnerable to these issues., last seen: 2019-02-21, modified: 2018-11-15, plugin id: 72642, published: 2014-02-23, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72642, title: Mandriva Linux Security Advisory : postgresql (MDVSA-2014:047)}, {NASL family: Databases, NASL id: POSTGRESQL_20140220.NASL, description: The version of PostgreSQL installed on the remote host is 8.4.x prior to 8.4.20, 9.0.x prior to 9.0.16, 9.1.x prior to 9.1.12, 9.2.x prior to 9.2.7 or 9.3.x prior to 9.3.3.  It is, therefore, potentially affected by multiple vulnerabilities :

  - SET ROLE bypasses lack of ADMIN OPTION when granting     roles. (CVE-2014-0060)

  - It is possible to elevate privileges via calls to     validator functions. (CVE-2014-0061)

  - It is possible to elevate privileges via a race     condition in CREATE INDEX. (CVE-2014-0062)

  - Potential buffer overruns exist due to integer overflow     in size calculations. (CVE-2014-0063)

  - Potential buffer overruns exist in datetime     input/output. (CVE-2014-0064)

  - Multiple fixed-size buffers exist that could potentially     be overflowed. (CVE-2014-0065)

  - A potential NULL pointer dereference crash is possible     when crypt(3) returns NULL. (CVE-2014-0066)     
  - Multiple integer overflow vulnerabilities exist in     'hstore_io.c' (CVE-2014-2669), last seen: 2019-02-21, modified: 2018-11-15, plugin id: 72659, published: 2014-02-24, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=72659, title: PostgreSQL 8.4 < 8.4.20 / 9.0 < 9.0.16 / 9.1 < 9.1.12 / 9.2 < 9.2.7 / 9.3 < 9.3.3 Multiple Vulnerabilities}, {NASL family: SuSE Local Security Checks, NASL id: OPENSUSE-2014-192.NASL, description: The PostgreSQL database was updated to the security and bugfix release 9.2.7, which following fixes :

  - Shore up GRANT ... WITH ADMIN OPTION restrictions     (CVE-2014-0060, bnc#864845)

  - Prevent privilege escalation via manual calls to PL     validator functions (CVE-2014-0061, bnc#864846)

  - Avoid multiple name lookups during table and index DDL     (CVE-2014-0062, bnc#864847)

  - Prevent buffer overrun with long datetime strings     (CVE-2014-0063, bnc#864850)

  - Prevent buffer overrun due to integer overflow in size     calculations (CVE-2014-0064, bnc#864851)

  - Prevent overruns of fixed-size buffers (CVE-2014-0065,     bnc#864852)

  - Avoid crashing if crypt() returns NULL (CVE-2014-0066,     bnc#864853)

  - Document risks of make check in the regression testing     instructions (CVE-2014-0067)

  - For the other (many!) bug fixes, see the release notes:
    http://www.postgresql.org/docs/9.3/static/release-9-2-7.
    html, last seen: 2019-02-21, modified: 2018-12-18, plugin id: 75281, published: 2014-06-13, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=75281, title: openSUSE Security Update : postgresql92 (openSUSE-SU-2014:0345-1)}, {NASL family: Amazon Linux Local Security Checks, NASL id: ALA_ALAS-2014-305.NASL, description: Multiple stack-based buffer overflow flaws were found in the date/time implementation of PostgreSQL. An authenticated database user could provide a specially crafted date/time value that, when processed, could cause PostgreSQL to crash or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL.
(CVE-2014-0063)

Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in various type input functions in PostgreSQL.
An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0064)

Multiple potential buffer overflow flaws were found in PostgreSQL. An authenticated database user could possibly use these flaws to crash PostgreSQL or, potentially, execute arbitrary code with the permissions of the user running PostgreSQL. (CVE-2014-0065)

It was found that granting a SQL role to a database user in a PostgreSQL database without specifying the 'ADMIN' option allowed the grantee to remove other users from their granted role. An authenticated database user could use this flaw to remove a user from a SQL role which they were granted access to. (CVE-2014-0060)

A flaw was found in the validator functions provided by PostgreSQL's procedural languages (PLs). An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0061)

A race condition was found in the way the CREATE INDEX command performed multiple independent lookups of a table that had to be indexed. An authenticated database user could possibly use this flaw to escalate their privileges. (CVE-2014-0062)

It was found that the chkpass extension of PostgreSQL did not check the return value of the crypt() function. An authenticated database user could possibly use this flaw to crash PostgreSQL via a NULL pointer dereference. (CVE-2014-0066), last seen: 2019-02-21, modified: 2018-04-18, plugin id: 73059, published: 2014-03-18, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=73059, title: Amazon Linux AMI : postgresql8 (ALAS-2014-305)}], ranking: [[{circl: 3}]], redhat: {advisories: [{rhsa: {id: RHSA-2014:0211}}, {rhsa: {id: RHSA-2014:0221}}, {rhsa: {id: RHSA-2014:0249}}, {rhsa: {id: RHSA-2014:0469}}], rpms: [postgresql84-0:8.4.20-1.el5_10, postgresql84-contrib-0:8.4.20-1.el5_10, postgresql84-devel-0:8.4.20-1.el5_10, postgresql84-docs-0:8.4.20-1.el5_10, postgresql84-libs-0:8.4.20-1.el5_10, postgresql84-plperl-0:8.4.20-1.el5_10, postgresql84-plpython-0:8.4.20-1.el5_10, postgresql84-pltcl-0:8.4.20-1.el5_10, postgresql84-python-0:8.4.20-1.el5_10, postgresql84-server-0:8.4.20-1.el5_10, postgresql84-tcl-0:8.4.20-1.el5_10, postgresql84-test-0:8.4.20-1.el5_10, postgresql-0:8.4.20-1.el6_5, postgresql-contrib-0:8.4.20-1.el6_5, postgresql-devel-0:8.4.20-1.el6_5, postgresql-docs-0:8.4.20-1.el6_5, postgresql-libs-0:8.4.20-1.el6_5, postgresql-plperl-0:8.4.20-1.el6_5, postgresql-plpython-0:8.4.20-1.el6_5, postgresql-pltcl-0:8.4.20-1.el6_5, postgresql-server-0:8.4.20-1.el6_5, postgresql-test-0:8.4.20-1.el6_5, postgresql-0:8.1.23-10.el5_10, postgresql-contrib-0:8.1.23-10.el5_10, postgresql-devel-0:8.1.23-10.el5_10, postgresql-docs-0:8.1.23-10.el5_10, postgresql-libs-0:8.1.23-10.el5_10, postgresql-pl-0:8.1.23-10.el5_10, postgresql-python-0:8.1.23-10.el5_10, postgresql-server-0:8.1.23-10.el5_10, postgresql-tcl-0:8.1.23-10.el5_10, postgresql-test-0:8.1.23-10.el5_10]}, references: [http://archives.neohapsis.com/archives/bugtraq/2014-10/0103.html, http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10705, http://lists.opensuse.org/opensuse-updates/2014-03/msg00018.html, http://lists.opensuse.org/opensuse-updates/2014-03/msg00038.html, http://rhn.redhat.com/errata/RHSA-2014-0211.html, http://rhn.redhat.com/errata/RHSA-2014-0221.html, http://rhn.redhat.com/errata/RHSA-2014-0249.html, http://rhn.redhat.com/errata/RHSA-2014-0469.html, http://secunia.com/advisories/61307, http://support.apple.com/kb/HT6448, http://wiki.postgresql.org/wiki/20140220securityrelease, http://www.debian.org/security/2014/dsa-2864, http://www.debian.org/security/2014/dsa-2865, http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html, http://www.postgresql.org/about/news/1506/, http://www.securityfocus.com/bid/65727, http://www.ubuntu.com/usn/USN-2120-1, https://support.apple.com/kb/HT6536], refmap: {apple: [APPLE-SA-2014-10-16-3], bid: [65727], confirm: [http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10705, http://support.apple.com/kb/HT6448, http://wiki.postgresql.org/wiki/20140220securityrelease, http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html, http://www.postgresql.org/about/news/1506/, https://support.apple.com/kb/HT6536], debian: [DSA-2864, DSA-2865], secunia: [61307], suse: [openSUSE-SU-2014:0345, openSUSE-SU-2014:0368], ubuntu: [USN-2120-1]}, summary: Race condition in the (1) CREATE INDEX and (2) unspecified ALTER TABLE commands in PostgreSQL before 8.4.20, 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allows remote authenticated users to create an unauthorized index or read portions of unauthorized tables by creating or deleting a table with the same name during the timing window., vulnerable_configuration: [{id: cpe:2.3:a:postgresql:postgresql:8.4.1, title: PostgreSQL 8.4.1}, {id: cpe:2.3:a:postgresql:postgresql:8.4.2, title: PostgreSQL 8.4.2}, {id: cpe:2.3:a:postgresql:postgresql:8.4.3, title: PostgreSQL 8.4.3}, {id: cpe:2.3:a:postgresql:postgresql:8.4.4, title: PostgreSQL 8.4.4}, {id: cpe:2.3:a:postgresql:postgresql:8.4.5, title: PostgreSQL 8.4.5}, {id: cpe:2.3:a:postgresql:postgresql:8.4.6, title: PostgreSQL 8.4.6}, {id: cpe:2.3:a:postgresql:postgresql:8.4.7, title: PostgreSQL 8.4.7}, {id: cpe:2.3:a:postgresql:postgresql:8.4.8, title: PostgreSQL 8.4.8}, {id: cpe:2.3:a:postgresql:postgresql:8.4.9, title: PostgreSQL 8.4.9}, {id: cpe:2.3:a:postgresql:postgresql:8.4.10, title: PostgreSQL 8.4.10}, {id: cpe:2.3:a:postgresql:postgresql:8.4.11, title: PostgreSQL 8.4.11}, {id: cpe:2.3:a:postgresql:postgresql:8.4.12, title: PostgreSQL 8.4.12}, {id: cpe:2.3:a:postgresql:postgresql:8.4.13, title: PostgreSQL 8.4.13}, {id: cpe:2.3:a:postgresql:postgresql:8.4.14, title: PostgreSQL 8.4.14}, {id: cpe:2.3:a:postgresql:postgresql:8.4.15, title: PostgreSQL 8.4.15}, {id: cpe:2.3:a:postgresql:postgresql:8.4.16, title: PostgreSQL 8.4.16}, {id: cpe:2.3:a:postgresql:postgresql:8.4.17, title: PostgreSQL PostgreSQL 8.4.17}, {id: cpe:2.3:a:postgresql:postgresql:8.4.18, title: PostgreSQL PostgreSQL 8.4.18}, {id: cpe:2.3:a:postgresql:postgresql:8.4.19, title: PostgreSQL PostgreSQL 8.4.19}, {id: cpe:2.3:a:postgresql:postgresql:9.0, title: PostgreSQL 9.0}, {id: cpe:2.3:a:postgresql:postgresql:9.0.1, title: PostgreSQL 9.0.1}, {id: cpe:2.3:a:postgresql:postgresql:9.0.2, title: PostgreSQL 9.0.2}, {id: cpe:2.3:a:postgresql:postgresql:9.0.3, title: PostgreSQL 9.0.3}, {id: cpe:2.3:a:postgresql:postgresql:9.0.4, title: PostgreSQL 9.0.4}, {id: cpe:2.3:a:postgresql:postgresql:9.0.5, title: PostgreSQL 9.0.5}, {id: cpe:2.3:a:postgresql:postgresql:9.0.6, title: PostgreSQL 9.0.6}, {id: cpe:2.3:a:postgresql:postgresql:9.0.7, title: PostgreSQL 9.0.7}, {id: cpe:2.3:a:postgresql:postgresql:9.0.8, title: PostgreSQL 9.0.8}, {id: cpe:2.3:a:postgresql:postgresql:9.0.9, title: PostgreSQL 9.0.9}, {id: cpe:2.3:a:postgresql:postgresql:9.0.10, title: PostgreSQL 9.0.10}, {id: cpe:2.3:a:postgresql:postgresql:9.0.11, title: PostgreSQL 9.0.11}, {id: cpe:2.3:a:postgresql:postgresql:9.0.12, title: PostgreSQL 9.0.12}, {id: cpe:2.3:a:postgresql:postgresql:9.0.13, title: PostgreSQL PostgreSQL 9.0.13}, {id: cpe:2.3:a:postgresql:postgresql:9.0.14, title: PostgreSQL PostgreSQL 9.0.14}, {id: cpe:2.3:a:postgresql:postgresql:9.0.15, title: PostgreSQL PostgreSQL 9.0.15}, {id: cpe:2.3:a:postgresql:postgresql:9.1, title: PostgreSQL 9.1}, {id: cpe:2.3:a:postgresql:postgresql:9.1.1, title: PostgreSQL 9.1.1}, {id: cpe:2.3:a:postgresql:postgresql:9.1.2, title: PostgreSQL 9.1.2}, {id: cpe:2.3:a:postgresql:postgresql:9.1.3, title: PostgreSQL 9.1.3}, {id: cpe:2.3:a:postgresql:postgresql:9.1.4, title: PostgreSQL 9.1.4}, {id: cpe:2.3:a:postgresql:postgresql:9.1.5, title: PostgreSQL 9.1.5}, {id: cpe:2.3:a:postgresql:postgresql:9.1.6, title: PostgreSQL 9.1.6}, {id: cpe:2.3:a:postgresql:postgresql:9.1.7, title: PostgreSQL 9.1.7}, {id: cpe:2.3:a:postgresql:postgresql:9.1.8, title: PostgreSQL 9.1.8}, {id: cpe:2.3:a:postgresql:postgresql:9.1.9, title: PostgreSQL PostgreSQL 9.1.9}, {id: cpe:2.3:a:postgresql:postgresql:9.1.10, title: PostgreSQL PostgreSQL 9.1.10}, {id: cpe:2.3:a:postgresql:postgresql:9.1.11, title: PostgreSQL PostgreSQL 9.1.11}, {id: cpe:2.3:a:postgresql:postgresql:9.2, title: PostgreSQL 9.2}, {id: cpe:2.3:a:postgresql:postgresql:9.2.1, title: PostgreSQL 9.2.1}, {id: cpe:2.3:a:postgresql:postgresql:9.2.2, title: PostgreSQL 9.2.2}, {id: cpe:2.3:a:postgresql:postgresql:9.2.3, title: PostgreSQL PostgreSQL 9.2.3}, {id: cpe:2.3:a:postgresql:postgresql:9.2.4, title: PostgreSQL PostgreSQL 9.2.4}, {id: cpe:2.3:a:postgresql:postgresql:9.2.5, title: PostgreSQL PostgreSQL 9.2.5}, {id: cpe:2.3:a:postgresql:postgresql:9.2.6, title: PostgreSQL PostgreSQL 9.2.6}, {id: cpe:2.3:a:postgresql:postgresql:9.3, title: PostgreSQL PostgreSQL 9.3}, {id: cpe:2.3:a:postgresql:postgresql:9.3.1, title: PostgreSQL PostgreSQL 9.3.1}, {id: cpe:2.3:a:postgresql:postgresql:9.3.2, title: PostgreSQL PostgreSQL 9.3.2}], vulnerable_configuration_cpe_2_2: [cpe:/a:postgresql:postgresql:8.4.1, cpe:/a:postgresql:postgresql:8.4.2, cpe:/a:postgresql:postgresql:8.4.3, cpe:/a:postgresql:postgresql:8.4.4, cpe:/a:postgresql:postgresql:8.4.5, cpe:/a:postgresql:postgresql:8.4.6, cpe:/a:postgresql:postgresql:8.4.7, cpe:/a:postgresql:postgresql:8.4.8, cpe:/a:postgresql:postgresql:8.4.9, cpe:/a:postgresql:postgresql:8.4.10, cpe:/a:postgresql:postgresql:8.4.11, cpe:/a:postgresql:postgresql:8.4.12, cpe:/a:postgresql:postgresql:8.4.13, cpe:/a:postgresql:postgresql:8.4.14, cpe:/a:postgresql:postgresql:8.4.15, cpe:/a:postgresql:postgresql:8.4.16, cpe:/a:postgresql:postgresql:8.4.17, cpe:/a:postgresql:postgresql:8.4.18, cpe:/a:postgresql:postgresql:8.4.19, cpe:/a:postgresql:postgresql:9.0, cpe:/a:postgresql:postgresql:9.0.1, cpe:/a:postgresql:postgresql:9.0.2, cpe:/a:postgresql:postgresql:9.0.3, cpe:/a:postgresql:postgresql:9.0.4, cpe:/a:postgresql:postgresql:9.0.5, cpe:/a:postgresql:postgresql:9.0.6, cpe:/a:postgresql:postgresql:9.0.7, cpe:/a:postgresql:postgresql:9.0.8, cpe:/a:postgresql:postgresql:9.0.9, cpe:/a:postgresql:postgresql:9.0.10, cpe:/a:postgresql:postgresql:9.0.11, cpe:/a:postgresql:postgresql:9.0.12, cpe:/a:postgresql:postgresql:9.0.13, cpe:/a:postgresql:postgresql:9.0.14, cpe:/a:postgresql:postgresql:9.0.15, cpe:/a:postgresql:postgresql:9.1, cpe:/a:postgresql:postgresql:9.1.1, cpe:/a:postgresql:postgresql:9.1.2, cpe:/a:postgresql:postgresql:9.1.3, cpe:/a:postgresql:postgresql:9.1.4, cpe:/a:postgresql:postgresql:9.1.5, cpe:/a:postgresql:postgresql:9.1.6, cpe:/a:postgresql:postgresql:9.1.7, cpe:/a:postgresql:postgresql:9.1.8, cpe:/a:postgresql:postgresql:9.1.9, cpe:/a:postgresql:postgresql:9.1.10, cpe:/a:postgresql:postgresql:9.1.11, cpe:/a:postgresql:postgresql:9.2, cpe:/a:postgresql:postgresql:9.2.1, cpe:/a:postgresql:postgresql:9.2.2, cpe:/a:postgresql:postgresql:9.2.3, cpe:/a:postgresql:postgresql:9.2.4, cpe:/a:postgresql:postgresql:9.2.5, cpe:/a:postgresql:postgresql:9.2.6, cpe:/a:postgresql:postgresql:9.3, cpe:/a:postgresql:postgresql:9.3.1, cpe:/a:postgresql:postgresql:9.3.2]}
