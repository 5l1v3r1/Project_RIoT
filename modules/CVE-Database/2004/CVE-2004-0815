{Modified: 2016-10-17T22:49:14.780000, Published: 2004-11-03T00:00:00, access: {authentication: NONE, complexity: LOW, vector: NETWORK}, cvss: 7.5, cvss-time: 2004-01-01T00:00:00, cwe: Unknown, id: CVE-2004-0815, impact: {availability: PARTIAL, confidentiality: PARTIAL, integrity: PARTIAL}, last-modified: 2018-10-30T12:25:11.107000, nessus: [{NASL family: Misc., NASL id: SAMBA_ARBITRARY_FILE_ACCESS.NASL, description: According to its version number, the remote Samba server is affected by a flaw that allows an attacker to access arbitrary files which exist outside of the shares's defined path.  An attacker needs a valid account to exploit this flaw., last seen: 2019-02-21, modified: 2018-11-15, plugin id: 15394, published: 2004-09-30, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=15394, title: Samba MS-DOS Path Request Arbitrary File Retrieval}, {NASL family: Debian Local Security Checks, NASL id: DEBIAN_DSA-600.NASL, description: A vulnerability has been discovered in samba, a commonly used LanManager-like file and printer server for Unix. A remote attacker may be able to gain access to files which exist outside of the share's defined path. Such files must still be readable by the account used for the connection, though., last seen: 2019-02-21, modified: 2018-08-09, plugin id: 15690, published: 2004-11-10, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=15690, title: Debian DSA-600-1 : samba - arbitrary file access}, {NASL family: SuSE Local Security Checks, NASL id: SUSE_SA_2004_035.NASL, description: The remote host is missing the patch for the advisory SUSE-SA:2004:035 (samba).


The Samba server, which allows to share files and resources via the SMB/CIFS protocol, contains a bug in the sanitation code of path names which allows remote attackers to access files outside of the defined share. In order to access these files, they must be readable by the account used for the SMB session.
CVE-2004-0815 has been assigned to this issue., last seen: 2019-02-21, modified: 2016-12-27, plugin id: 15423, published: 2004-10-05, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=15423, title: SUSE-SA:2004:035: samba}, {NASL family: Mandriva Local Security Checks, NASL id: MANDRAKE_MDKSA-2004-104.NASL, description: Karol Wiesek discovered a bug in the input validation routines used to convert DOS path names to path names on the Samba host's file system.
This bug can be exploited to gain access to files outside of the share's path as defined in the smb.conf configuration file. This vulnerability exists in all samba 2.2.x versions up to and including 2.2.11 and also in samba 3.0.x up to and including 3.0.5.

The updated packages have been patched to correct this issue., last seen: 2019-02-21, modified: 2018-07-19, plugin id: 15413, published: 2004-10-02, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=15413, title: Mandrake Linux Security Advisory : samba (MDKSA-2004:104)}, {NASL family: FreeBSD Local Security Checks, NASL id: FREEBSD_PKG_DE16B056132E11D9BC4A000C41E2CDAD.NASL, description: According to a Samba Team security notice :

A security vulnerability has been located in Samba 2.2.x <= 2.2.11 and Samba 3.0.x <= 3.0.5. A remote attacker may be able to gain access to files which exist outside of the share's defined path. Such files must still be readable by the account used for the connection.

The original notice for CAN-2004-0815 indicated that Samba 3.0.x <= 3.0.5 was vulnerable to the security issue. After further research, Samba developers have confirmed that only Samba 3.0.2a and earlier releases contain the exploitable code., last seen: 2019-02-21, modified: 2018-11-23, plugin id: 19144, published: 2005-07-13, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=19144, title: FreeBSD : samba -- remote file disclosure (de16b056-132e-11d9-bc4a-000c41e2cdad)}, {NASL family: Red Hat Local Security Checks, NASL id: REDHAT-RHSA-2004-498.NASL, description: Updated samba packages that fix an input validation vulnerability are now available.

Samba provides file and printer sharing services to SMB/CIFS clients.

Karol Wiesek discovered an input validation issue in Samba prior to 3.0.6. An authenticated user could send a carefully crafted request to the Samba server, which would allow access to files outside of the configured file share. Note: Such files would have to be readable by the account used for the connection. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name CVE-2004-0815 to this issue.

This issue does not affect Red Hat Enterprise Linux 3 as a previous erratum updated to Samba 3.0.6 which is not vulnerable to this issue.

Users of Samba should upgrade to these updated packages, which contain an upgrade to Samba-2.2.12, which is not vulnerable to this issue., last seen: 2019-02-21, modified: 2018-11-15, plugin id: 15428, published: 2004-10-06, reporter: Tenable, source: https://www.tenable.com/plugins/index.php?view=single&id=15428, title: RHEL 2.1 : samba (RHSA-2004:498)}], ranking: [[{circl: 3}]], redhat: {advisories: [{rhsa: {id: RHSA-2004:498}}]}, references: [http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000873, http://marc.info/?l=bugtraq&m=109655827913457&w=2, http://sunsolve.sun.com/search/document.do?assetkey=1-26-101584-1, http://sunsolve.sun.com/search/document.do?assetkey=1-26-57664-1, http://sunsolve.sun.com/search/document.do?assetkey=1-66-200529-1, http://us4.samba.org/samba/news/#security_2.2.12, http://www.debian.org/security/2004/dsa-600, http://www.idefense.com/application/poi/display?id=146&type=vulnerabilities&flashstatus=true, http://www.mandrakesecure.net/en/advisories/advisory.php?name=MDKSA-2004:104, http://www.novell.com/linux/security/advisories/2004_35_samba.html, http://www.redhat.com/support/errata/RHSA-2004-498.html, http://www.securityfocus.com/archive/1/377618, http://www.securityfocus.com/bid/11281, http://www.trustix.org/errata/2004/0051/, https://bugzilla.fedora.us/show_bug.cgi?id=2102, https://exchange.xforce.ibmcloud.com/vulnerabilities/17556], refmap: {bid: [11281], bugtraq: [20040930 Samba Security Announcement -- Potential Arbitrary File Access, 20041005 ERRATA: Potential Arbitrary File Access (CAN-2004-0815)], conectiva: [CLA-2004:873], confirm: [http://us4.samba.org/samba/news/#security_2.2.12], debian: [DSA-600], fedora: [FLSA:2102], idefense: [20040930 Samba Arbitrary File Access Vulnerability], mandrake: [MDKSA-2004:104], sunalert: [101584, 200529, 57664], suse: [SUSE-SA:2004:035], trustix: [2004-0051], xf: [samba-file-access(17556)]}, summary: The unix_clean_name function in Samba 2.2.x through 2.2.11, and 3.0.x before 3.0.2a, trims certain directory names down to absolute paths, which could allow remote attackers to bypass the specified share restrictions and read, write, or list arbitrary files via "/.////" style sequences in pathnames., vulnerable_configuration: [{id: cpe:2.3:a:samba:samba:2.2.0, title: Samba 2.2.0}, {id: cpe:2.3:a:samba:samba:2.2.0a, title: Samba Samba 2.2.0a}, {id: cpe:2.3:a:samba:samba:2.2.1a, title: Samba Samba 2.2.1a}, {id: cpe:2.3:a:samba:samba:2.2.2, title: Samba 2.2.2}, {id: cpe:2.3:a:samba:samba:2.2.3, title: Samba 2.2.3}, {id: cpe:2.3:a:samba:samba:2.2.3a, title: Samba Samba 2.2.3a}, {id: cpe:2.3:a:samba:samba:2.2.4, title: Samba 2.2.4}, {id: cpe:2.3:a:samba:samba:2.2.5, title: Samba 2.2.5}, {id: cpe:2.3:a:samba:samba:2.2.6, title: Samba 2.2.6}, {id: cpe:2.3:a:samba:samba:2.2.7, title: Samba 2.2.7}, {id: cpe:2.3:a:samba:samba:2.2.7a, title: Samba Samba 2.2.7a}, {id: cpe:2.3:a:samba:samba:2.2.8, title: Samba 2.2.8}, {id: cpe:2.3:a:samba:samba:2.2.8a, title: Samba Samba 2.2.8a}, {id: cpe:2.3:a:samba:samba:2.2.9, title: Samba 2.2.9}, {id: cpe:2.3:a:samba:samba:2.2.11, title: Samba 2.2.11}, {id: cpe:2.3:a:samba:samba:2.2a, title: Samba Samba 2.2a}, {id: cpe:2.3:a:samba:samba:3.0.0, title: Samba 3.0.0}, {id: cpe:2.3:a:samba:samba:3.0.1, title: Samba 3.0.1}, {id: cpe:2.3:a:samba:samba:3.0.2, title: Samba 3.0.2}, {id: cpe:2.3:a:samba:samba:3.0.2a, title: Samba 3.0.2a}], vulnerable_configuration_cpe_2_2: [cpe:/a:samba:samba:2.2.0, cpe:/a:samba:samba:2.2.0a, cpe:/a:samba:samba:2.2.1a, cpe:/a:samba:samba:2.2.2, cpe:/a:samba:samba:2.2.3, cpe:/a:samba:samba:2.2.3a, cpe:/a:samba:samba:2.2.4, cpe:/a:samba:samba:2.2.5, cpe:/a:samba:samba:2.2.6, cpe:/a:samba:samba:2.2.7, cpe:/a:samba:samba:2.2.7a, cpe:/a:samba:samba:2.2.8, cpe:/a:samba:samba:2.2.8a, cpe:/a:samba:samba:2.2.9, cpe:/a:samba:samba:2.2.11, cpe:/a:samba:samba:2.2a, cpe:/a:samba:samba:3.0.0, cpe:/a:samba:samba:3.0.1, cpe:/a:samba:samba:3.0.2, cpe:/a:samba:samba:3.0.2a]}
